<!-- component -->
<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="style.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    </head>
    <body class="bg-white rounded-lg py-5 flex justify-center items-center">  
        
        <!-- log In Page -->

        <div id="logInForm" class="w-[600px] h-[700px] bg-white shadow-xl shadow-black rounded-3xl">
            <div class="flex justify-center items-center flex-col p-9">
                <h1 class="text-5xl">TO DO</h1>
                <h2 class="p-11">Login / Sign Up</h2>
                <form class="flex flex-col space-y-5" action="">
                    <div class="flex flex-col space-y-1">
                        <input
                        required
                        placeholder="Email" type="email" id="email" autofocus 
                        class="px-4 py-2 transition duration-300 border border-gray-300 rounded focus:border-transparent focus:outline-none focus:ring-4 focus:ring-blue-200"
                        />
                    </div>
                    <div class="flex flex-col space-y-1">
                        <input type="password" id="password" placeholder="Password" required
                          class="px-4 py-2 transition duration-300 border border-gray-300 rounded focus:border-transparent focus:outline-none focus:ring-4 focus:ring-blue-200"
                        />
                    </div>
                    <button id="login" class="w-full px-4 py-2 text-lg font-semibold text-white transition-colors duration-300 bg-blue-500 rounded-md shadow hover:bg-blue-600 focus:outline-none focus:ring-blue-200 focus:ring-4" type="submit">Log In</button>
                    <button id="signup" class="w-full px-4 py-2 text-lg font-semibold text-white transition-colors duration-300 bg-blue-500 rounded-md shadow hover:bg-blue-600 focus:outline-none focus:ring-blue-200 focus:ring-4" type="submit">Sign Up</button>
                </form>
            </div>            
        </div>

        <!-- To Do List -->

        <div id="todolist-page" class="w-[600px] h-[700px] bg-white shadow-xl shadow-black rounded-3xl flex flex-col pt-0 space-y-8 p-8">
            <div class="flex flex-col justify-between mt-10 ml-4 space-y-6">
                <div class="flex flex-row justify-between">
                    <h3 class="text-xl">Hi, Atharv</h3>
                    <button class="float-right h-15 w-30 rounded-xl p-3 text-lg font-semibold text-white transition-colors duration-300 bg-blue-500 shadow hover:bg-blue-600 focus:outline-none focus:ring-blue-200 focus:ring-4">Log Out</button>
                </div>
                <hr>
            </div>
            <div >
                <ul class="flex flex-col space-y-2">
                    <li class="">
                        <div class="bg-slate-50 pl-5 p-2 w-full rounded-xl text-black shadow-black shadow-sm flex flex-row space-x-1">
                            <p>asdfadf</p>
                            <div class="text-[20px] flex flex-row space-x-3 justify-end w-full">
                                <i class="bi bi-check2-square"></i>
                                <i class="pl-3 bi bi-pencil-square"></i>
                                <i class="bi bi-trash"></i>
                            </div> 
                        </div>
                    </li>                  
                </ul>
            </div>
            <input
                        required
                        placeholder="Task" type="text" id="taskId" autofocus 
                        class="px-4 py-2 transition duration-300 border border-gray-300 rounded focus:border-transparent focus:outline-none focus:ring-4 focus:ring-blue-200"
                        />
            <button id="addtast" class="h-15 w-30 rounded-xl p-3 text-lg font-semibold text-white transition-colors duration-300 bg-blue-500 shadow hover:bg-blue-600 focus:outline-none focus:ring-blue-200 focus:ring-4">Add Task</button>
        </div>        
    </body>
    <script type="module">
/*++++++++++++++++++++++++++++++ Firebase Auth ++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */

        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js";
        import { getAuth, 
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            signOut,
            onAuthStateChanged
         } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-auth.js";

        import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-database.js";


        const firebaseConfig = {
            apiKey: "AIzaSyCJ7v-dM_MMZ5cFyPZvq_nXP6Q9cowARHU",
            authDomain: "todolist-fb8ec.firebaseapp.com",
            databaseURL: "https://todolist-fb8ec-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "todolist-fb8ec",
            storageBucket: "todolist-fb8ec.appspot.com",
            messagingSenderId: "1064224599646",
            appId: "1:1064224599646:web:97732c6ab4435a885b0ecf"
        };

        const app = initializeApp(firebaseConfig);

//++++++++++++++++++++++++++++++ Log In Page ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++        

        const email = document.querySelector("#email");
        const password = document.querySelector("#password");
        const logIn = document.querySelector("#login");
        const signUp = document.querySelector("#signup");
        const loginFormPage = document.querySelector("#logInForm");
        const todoListPage = document.querySelector("#todolist-page"); 

        const auth = getAuth();

        signUp.addEventListener('click',(e)=>{
            e.preventDefault();
            createUserWithEmailAndPassword(auth, email.value, password.value)
            .then((userCredential) => {
            // Signed up 
            const user = userCredential.user;
            alert(`Hi ${user.email} your account is created`);
            })
            .catch((error) => {
            const errorCode = error.code;
            const errorMessage = error.message;
            alert(error, errorMessage);
            });
        });

        logIn.addEventListener('click',(e)=>{
            e.preventDefault();
            signInWithEmailAndPassword(auth, email.value, password.value)
            .then((userCredential) => {
            const user = userCredential.user;
            alert(user.uid) 
            })
            .catch((error) => {
             const errorCode = error.code;
             const errorMessage = error.message;
             alert(errorMessage);
            });
        });

//++++++++++++++++++++++++++++++++++++ To Do List Page ++++++++++++++++++++++++++++
        const addTast = document.querySelector("#addtast");
        const taskId = document.querySelector('#taskId');
        const list = document.querySelector('ul');

        let listItem = `<li class="">
                        <div class="bg-slate-50 pl-5 p-2 w-full rounded-xl text-black shadow-black shadow-sm flex flex-row space-x-1">
                            <p>asdfasdf</p>
                            <div class="text-[20px] flex flex-row space-x-3 justify-end w-full">
                                <i class="bi bi-check2-square"></i>
                                <i class="pl-3 bi bi-pencil-square"></i>
                                <i class="bi bi-trash"></i>
                            </div> 
                        </div>
                        </li>`;

// +++++++++++++++++++++++++++++++ using offline object based data for tasks ++++++++++++++++++++++++++++++++++++++++
       user = auth.currentUser;
       userId = user.uid                     
       let data = {
        userId : {
            taskId : {
                completed : false
            }
        }
       }

       // create task

       function createTask(task, userUID){
        data[userUID] = {task : {completed: false}}
       }

       addTast.addEventListener('click',(e) => {
        e.preventDefault();
        task = taskId.value;
        alert(task);
        // createTask(task, userId);
        console.log(data);
       })
 
// +++++++++++++++++++++++ checking authstate +++++++++++++++++++

       async function checkUserSignedIn(){
        onAuthStateChanged(auth, user =>{
            if(user){
                loginFormPage.style.display = 'none';
                todoListPage.style.display = 'block'
            }else{
                loginFormPage.style.display = 'block';
                todoListPage.style.display = 'none'
            }
        })
       }

       checkUserSignedIn();
        
    </script>
<html>